C51 COMPILER V9.54   MAIN                                                                  06/22/2018 14:55:28 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: E:\Keil\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings
                    -\main.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          //====ä¸»ç¨‹åºæ–‡ä»¶=====================================================
   2          
   3          #include "reg52.h"       //æ­¤æ–‡ä»¶ä¸­å®šä¹‰äº†å•ç‰‡æœºçš„ä¸€äº›ç‰¹æ®ŠåŠŸèƒ½å¯„å­˜å™¨
   4          #include "ds18b20.h"  
   5          
   6          typedef unsigned int u16;   //å¯¹æ•°æ®ç±»å‹è¿›è¡Œå£°æ˜å®šä¹‰
   7          typedef unsigned char u8;
   8          
   9          sbit LSA=P2^2;
  10          sbit LSB=P2^3;
  11          sbit LSC=P2^4;
  12          
  13          
  14          char num=0;
  15          u8 DisplayData[8];
  16          u8 code smgduan[10]={0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07,0x7f,0x6f};
  17          
  18          /*******************************************************************************
  19          * å‡½ æ•° å         : delay
  20          * å‡½æ•°åŠŸèƒ½       : å»¶æ—¶å‡½æ•°ï¼Œi=1æ—¶ï¼Œå¤§çº¦å»¶æ—¶10us
  21          *******************************************************************************/
  22          void delay(u16 i)
  23          {
  24   1        while(i--); 
  25   1      }
  26          
  27          
  28          /*******************************************************************************
  29          * å‡½ æ•° å         : datapros()
  30          * å‡½æ•°åŠŸèƒ½       : æ¸©åº¦è¯»å–å¤„ç†è½¬æ¢å‡½æ•°
  31          * è¾“    å…¥         : temp
  32          * è¾“    å‡º         : æ— 
  33          *******************************************************************************/
  34          
  35          void datapros(int temp)    
  36          {
  37   1          float tp;  
  38   1        if(temp< 0)       //å½“æ¸©åº¦å€¼ä¸ºè´Ÿæ•°
  39   1          {
  40   2          DisplayData[0] = 0x40;    //   -
  41   2          //å› ä¸ºè¯»å–çš„æ¸©åº¦æ˜¯å®é™…æ¸©åº¦çš„è¡¥ç ï¼Œæ‰€ä»¥å‡1ï¼Œå†å–åæ±‚å‡ºåŸç 
  42   2          temp=temp-1;
  43   2          temp=~temp;
  44   2          tp=temp;
  45   2          temp=tp*0.0625*100+0.5; 
  46   2          //ç•™ä¸¤ä¸ªå°æ•°ç‚¹å°±*100ï¼Œ+0.5æ˜¯å››èˆäº”å…¥ï¼Œå› ä¸ºCè¯­è¨€æµ®ç‚¹æ•°è½¬æ¢ä¸ºæ•´å‹çš„æ—¶å€™æŠŠå°
             -æ•°ç‚¹
  47   2          //åé¢çš„æ•°è‡ªåŠ¨å»æ‰ï¼Œä¸ç®¡æ˜¯å¦å¤§äº0.5ï¼Œè€Œ+0.5ä¹‹åå¤§äº0.5çš„å°±æ˜¯è¿›1äº†ï¼Œå°äº0.5ç
             -š„å°±
  48   2          //ç®—åŠ ä¸Š0.5ï¼Œè¿˜æ˜¯åœ¨å°æ•°ç‚¹åé¢ã€‚
  49   2       
  50   2          }
  51   1        else
  52   1          {     
C51 COMPILER V9.54   MAIN                                                                  06/22/2018 14:55:28 PAGE 2   

  53   2          DisplayData[0] = 0x00;
  54   2          tp=temp;//å› ä¸ºæ•°æ®å¤„ç†æœ‰å°æ•°ç‚¹æ‰€ä»¥å°†æ¸©åº¦èµ‹ç»™ä¸€ä¸ªæµ®ç‚¹å‹å˜é‡
  55   2          //å¦‚æœæ¸©åº¦æ˜¯æ­£çš„é‚£ä¹ˆï¼Œé‚£ä¹ˆæ­£æ•°çš„åŸç å°±æ˜¯è¡¥ç å®ƒæœ¬èº«
  56   2          temp=tp*0.0625*100+0.5; 
  57   2          //ç•™ä¸¤ä¸ªå°æ•°ç‚¹å°±*100ï¼Œ+0.5æ˜¯å››èˆäº”å…¥ï¼Œå› ä¸ºCè¯­è¨€æµ®ç‚¹æ•°è½¬æ¢ä¸ºæ•´å‹çš„æ—¶å€™æŠŠå°
             -æ•°ç‚¹
  58   2          //åé¢çš„æ•°è‡ªåŠ¨å»æ‰ï¼Œä¸ç®¡æ˜¯å¦å¤§äº0.5ï¼Œè€Œ+0.5ä¹‹åå¤§äº0.5çš„å°±æ˜¯è¿›1äº†ï¼Œå°äº0.5ç
             -š„å°±
  59   2          //ç®—åŠ ä¸Š0.5ï¼Œè¿˜æ˜¯åœ¨å°æ•°ç‚¹åé¢ã€‚
  60   2        }
  61   1        DisplayData[1] = smgduan[temp / 10000];
  62   1        DisplayData[2] = smgduan[temp % 10000 / 1000];
  63   1        DisplayData[3] = smgduan[temp % 1000 / 100] | 0x80;
  64   1        DisplayData[4] = smgduan[temp % 100 / 10];
  65   1        DisplayData[5] = smgduan[temp % 10];
  66   1      }
  67          
  68          
  69          /*******************************************************************************
  70          * å‡½æ•°å         :DigDisplay()
  71          * å‡½æ•°åŠŸèƒ½     :æ•°ç ç®¡æ˜¾ç¤ºå‡½æ•°
  72          * è¾“å…¥           : æ— 
  73          * è¾“å‡º           : æ— 
  74          *******************************************************************************/
  75          void DigDisplay()
  76          {
  77   1        u8 i;
  78   1        for(i=0;i<6;i++)
  79   1        {
  80   2          switch(i)  //ä½é€‰ï¼Œé€‰æ‹©ç‚¹äº®çš„æ•°ç ç®¡ï¼Œ
  81   2          {
  82   3            case(0):
  83   3              LSA=0;LSB=0;LSC=0; break;//æ˜¾ç¤ºç¬¬0ä½
  84   3            case(1):
  85   3              LSA=1;LSB=0;LSC=0; break;//æ˜¾ç¤ºç¬¬1ä½
  86   3            case(2):
  87   3              LSA=0;LSB=1;LSC=0; break;//æ˜¾ç¤ºç¬¬2ä½
  88   3            case(3):
  89   3              LSA=1;LSB=1;LSC=0; break;//æ˜¾ç¤ºç¬¬3ä½
  90   3            case(4):
  91   3              LSA=0;LSB=0;LSC=1; break;//æ˜¾ç¤ºç¬¬4ä½
  92   3            case(5):
  93   3              LSA=1;LSB=0;LSC=1; break;//æ˜¾ç¤ºç¬¬5ä½  
  94   3          }
  95   2          P0=DisplayData[i];//å‘é€æ•°æ®
  96   2          delay(100); //é—´éš”ä¸€æ®µæ—¶é—´æ‰«æ  
  97   2          P0=0x00;//æ¶ˆéš
  98   2        }   
  99   1      }
 100          
 101          /*******************************************************************************
 102          * å‡½ æ•° å       : main
 103          * å‡½æ•°åŠŸèƒ½     : ä¸»å‡½æ•°
 104          * è¾“    å…¥       : æ— 
 105          * è¾“    å‡º       : æ— 
 106          *******************************************************************************/
 107          void main()
 108          { 
 109   1        while(1)
 110   1        {
 111   2          datapros(Ds18b20ReadTemp());   //æ•°æ®å¤„ç†å‡½æ•°
 112   2          DigDisplay();//æ•°ç ç®¡æ˜¾ç¤ºå‡½æ•°    
C51 COMPILER V9.54   MAIN                                                                  06/22/2018 14:55:28 PAGE 3   

 113   2        }   
 114   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    348    ----
   CONSTANT SIZE    =     10    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      9       4
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
